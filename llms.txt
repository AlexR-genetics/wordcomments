# wordcomments

**wordcomments** is an R package for extracting, analyzing, and managing
comments from Microsoft Word (.docx) documents. Itâ€™s particularly useful
for academic manuscript revision workflows and collaborative document
review.

## Features

- ğŸ“„ **Extract comments** with full metadata (author, date, position,
  resolution status)
- ğŸ§µ **Thread detection** for comment conversations and replies
- ğŸ‘¥ **Filter by reviewer** for multi-author documents
- ğŸ“Š **Summary statistics** on comment activity
- ğŸ“ **Generate response tables** for journal revisions
- ğŸ“¤ **Export** to Excel, Word, CSV, Markdown, or HTML

## Installation

Install the development version from GitHub:

``` r
# install.packages("devtools")
devtools::install_github("AlexR-genetics/wordcomments")
```

## Quick Start

``` r
library(wordcomments)

# Check if a document has comments
has_comments("manuscript.docx")

# Extract all comments
comments <- extract_comments("manuscript.docx")

# View summary statistics
comment_summary(comments)
```

## Usage Examples

### Extract Comments

``` r
# Extract all comments
comments <- extract_comments("manuscript.docx")

# Extract only unresolved comments
open_comments <- extract_comments("manuscript.docx", include_resolved = FALSE)
```

The returned data frame includes: \| Column \| Description \|
\|â€”â€”â€“\|â€”â€”â€”â€”-\| \| Text \| The text that was commented on \| \| Comment
\| The comment content \| \| Author \| Comment author \| \| Date \|
Timestamp \| \| Line \| Paragraph number (position in document) \| \|
Page \| Estimated page number \| \| Resolved \| Whether the comment
thread is resolved \|

### Summary Statistics

``` r
summary <- comment_summary(comments)
print(summary)

# Output:
# === COMMENT SUMMARY ===
# 
# OVERVIEW
#   Total comments:    24
#   Resolved:          8 (33.3%)
#   Unresolved:        16
#   Unique authors:    3
#
# BY AUTHOR
#   Reviewer 1           12 comments (4 resolved, 8 open)
#   Reviewer 2            8 comments (3 resolved, 5 open)
#   Editor                4 comments (1 resolved, 3 open)
```

### Filter by Reviewer

``` r
# Get comments from a specific reviewer
reviewer1 <- comments_by_reviewer(comments, reviewer = "Smith")

# Split into separate data frames by reviewer
by_reviewer <- comments_by_reviewer(comments, split = TRUE)
names(by_reviewer)  # Lists all reviewers
```

### Find Comment Threads

``` r
# Add thread information to comments
threaded <- find_comment_threads(comments)
# Adds: thread_id, thread_size, reply_depth

# Get nested list structure
threads <- find_comment_threads(comments, flatten = FALSE)
```

### Generate Response Table

Perfect for journal manuscript revisions:

``` r
# Generate and export response table
generate_response_table("manuscript.docx", "response_to_reviewers.xlsx")
```

Creates a table with columns: - \# (comment number) - Reviewer -
Location (page/line) - Commented Text - Reviewer Comment - Author
Response (empty - for you to fill) - Action Taken (empty - for you to
fill) - Line in Revision (empty - for you to fill)

### Export Comments

``` r
# Export to various formats
export_comments(comments, "comments.xlsx")
export_comments(comments, "comments.docx")
export_comments(comments, "comments.csv")
export_comments(comments, "comments.md")
export_comments(comments, "comments.html")

# Export only unresolved comments
export_comments(comments, "open_comments.xlsx", include_resolved = FALSE)

# Export specific columns
export_comments(comments, "simple.csv", 
                columns = c("Author", "Comment", "Resolved"))
```

## Typical Workflow for Manuscript Revision

``` r
library(wordcomments)

# 1. Load commented manuscript
comments <- extract_comments("reviewed_manuscript.docx")

# 2. Get overview
comment_summary(comments)

# 3. Generate response document for the journal
generate_response_table(comments, "response_to_reviewers.xlsx",
                        include_resolved = FALSE)

# 4. Open in Excel, fill in your responses, submit to journal!
```

## Technical Notes

- **Line numbers**: Word doesnâ€™t store true line numbers internally. The
  `Line` column represents paragraph position, which serves as a
  reliable reference point.
- **Page numbers**: These are estimated (~25 paragraphs per page) since
  Word calculates pages at render time based on fonts/margins.
- **Resolution status**: The package checks multiple XML files
  (`commentsExtended.xml`, `commentsExtensible.xml`) to detect resolved
  comments across different Word versions.

## Dependencies

- xml2
- officer  
- openxlsx
- dplyr
- stringr
- tidyr
- rlang

## Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

## License

MIT Â© Alexandros Rammos

## Citation

If you use this package in your research, please cite it:

    @software{wordcomments,
      author = {Rammos, Alexandros},
      title = {wordcomments: Extract and Analyze Comments from Word Documents},
      year = {2025},
      url = {https://github.com/AlexR-genetics/wordcomments}
    }

# Package index

## Extract Comments

Core functions for extracting comments from Word documents

- [`extract_comments()`](https://alexr-genetics.github.io/wordcomments/reference/extract_comments.md)
  : Extract comments from a Word document
- [`has_comments()`](https://alexr-genetics.github.io/wordcomments/reference/has_comments.md)
  : Check if a Word document contains comments

## Analyze Comments

Functions for analyzing and organizing comments

- [`comment_summary()`](https://alexr-genetics.github.io/wordcomments/reference/comment_summary.md)
  : Generate summary statistics for comments
- [`print(`*`<comment_summary>`*`)`](https://alexr-genetics.github.io/wordcomments/reference/print.comment_summary.md)
  : Print method for comment_summary
- [`comments_by_reviewer()`](https://alexr-genetics.github.io/wordcomments/reference/comments_by_reviewer.md)
  : Filter or split comments by reviewer/author
- [`find_comment_threads()`](https://alexr-genetics.github.io/wordcomments/reference/find_comment_threads.md)
  : Group comments into conversation threads

## Export & Reporting

Functions for exporting comments and generating reports

- [`export_comments()`](https://alexr-genetics.github.io/wordcomments/reference/export_comments.md)
  : Export comments to various formats
- [`generate_response_table()`](https://alexr-genetics.github.io/wordcomments/reference/generate_response_table.md)
  : Generate a response table for reviewer comments

## Package

Package documentation

- [`wordcomments`](https://alexr-genetics.github.io/wordcomments/reference/wordcomments-package.md)
  [`wordcomments-package`](https://alexr-genetics.github.io/wordcomments/reference/wordcomments-package.md)
  : wordcomments: Extract and Analyze Comments from Word Documents

